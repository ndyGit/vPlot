<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>../main_edit_mode.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../assets/css/logo.png" title=""></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/AbstractPlugin.html">AbstractPlugin</a></li>
            
                <li><a href="../classes/Config.html">Config</a></li>
            
                <li><a href="../classes/Controls.html">Controls</a></li>
            
                <li><a href="../classes/Plot.html">Plot</a></li>
            
                <li><a href="../classes/Plugin 3D.html">Plugin 3D</a></li>
            
                <li><a href="../classes/Plugin Axes.html">Plugin Axes</a></li>
            
                <li><a href="../classes/Plugin BasicMaterial.html">Plugin BasicMaterial</a></li>
            
                <li><a href="../classes/Plugin CameraControl.html">Plugin CameraControl</a></li>
            
                <li><a href="../classes/Plugin Color.html">Plugin Color</a></li>
            
                <li><a href="../classes/Plugin Dataset.html">Plugin Dataset</a></li>
            
                <li><a href="../classes/Plugin File.html">Plugin File</a></li>
            
                <li><a href="../classes/Plugin Function.html">Plugin Function</a></li>
            
                <li><a href="../classes/Plugin Heatmap.html">Plugin Heatmap</a></li>
            
                <li><a href="../classes/Plugin Light.html">Plugin Light</a></li>
            
                <li><a href="../classes/Plugin LinePlot.html">Plugin LinePlot</a></li>
            
                <li><a href="../classes/Plugin Plane.html">Plugin Plane</a></li>
            
                <li><a href="../classes/Plugin ScatterPlot.html">Plugin ScatterPlot</a></li>
            
                <li><a href="../classes/Plugin SurfacePlot.html">Plugin SurfacePlot</a></li>
            
                <li><a href="../classes/Plugin WireframeMaterial.html">Plugin WireframeMaterial</a></li>
            
                <li><a href="../classes/SceneGraph.html">SceneGraph</a></li>
            
                <li><a href="../classes/Templates.html">Templates</a></li>
            
                <li><a href="../classes/Toolbox.html">Toolbox</a></li>
            
                <li><a href="../classes/UTILS.html">UTILS</a></li>
            
                <li><a href="../classes/VLib.html">VLib</a></li>
            
                <li><a href="../classes/VMediator.html">VMediator</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/Controls.html">Controls</a></li>
            
                <li><a href="../modules/main.html">main</a></li>
            
                <li><a href="../modules/Plot.html">Plot</a></li>
            
                <li><a href="../modules/SceneGraph.html">SceneGraph</a></li>
            
                <li><a href="../modules/Templates.html">Templates</a></li>
            
                <li><a href="../modules/Toolbox.html">Toolbox</a></li>
            
                <li><a href="../modules/VLib.html">VLib</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: ../main_edit_mode.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
requirejs.config({

	paths : {
		&#x27;vlib&#x27; : &#x27;core/Vlib&#x27;,
		&#x27;config&#x27; : &#x27;config.vlib&#x27;,
		&#x27;pluginLoader&#x27; : &#x27;pluginLoader&#x27;,
		&#x27;jquery_ui&#x27; : &#x27;libs/jquery-ui/js/jquery-ui-1.10.3.custom.min&#x27;,
		&#x27;jquery&#x27; : &#x27;libs/jquery/jquery.min&#x27;,
		&#x27;underscore&#x27; : &#x27;libs/underscore/underscore.min&#x27;,
		&#x27;three&#x27; : &#x27;libs/three/build/three&#x27;,
		&#x27;three_trackball_controls&#x27; : &#x27;libs/three/controls/TrackballControls&#x27;,
		&#x27;three_orbit_controls&#x27; : &#x27;libs/three/controls/OrbitAndPanControls&#x27;,
		&#x27;three_buffer&#x27; : &#x27;libs/three/build/BufferGeometryUtils&#x27;,
		&#x27;orgChart&#x27; : &#x27;libs/jOrgChart/jquery.jOrgChart&#x27;,
		&#x27;bootstrap&#x27;:&#x27;libs/bootstrap/bootstrap.min&#x27;,
		&#x27;d3&#x27;:&#x27;libs/novus/lib/d3.v3&#x27;,
		&#x27;nv&#x27;:&#x27;libs/novus/nv.d3&#x27;


	},
	shim : {
		&#x27;underscore&#x27; : {
			exports : &#x27;_&#x27;
		},
		&#x27;three&#x27; : {
			exports : &#x27;THREE&#x27;
		},
		&#x27;three_buffer&#x27; : {
			&#x27;deps&#x27; : [&#x27;three&#x27;],
			exports : &#x27;THREE&#x27;
		},
		&#x27;three_trackball_controls&#x27; : {
			exports : &#x27;THREE&#x27;,
			&#x27;deps&#x27; : [&#x27;three&#x27;]
		},
		&#x27;three_orbit_controls&#x27; : {
			exports : &#x27;THREE&#x27;,
			&#x27;deps&#x27; : [&#x27;three&#x27;]
		},
		&#x27;jquery_ui&#x27; : {
			exports : &#x27;$&#x27;,
			&#x27;deps&#x27; : [&#x27;jquery&#x27;]
		},
		&#x27;orgChart&#x27; : {
			exports : &#x27;$&#x27;,
			&#x27;deps&#x27; : [&#x27;jquery&#x27;]
		},
		&#x27;bootstrap&#x27; : {
			&#x27;deps&#x27; : [&#x27;jquery&#x27;]
		},
		&#x27;d3&#x27;:{
			exports: &#x27;d3&#x27;
		},
		&#x27;nv&#x27;:{
			&#x27;deps&#x27; : [&#x27;d3&#x27;],
			exports: &#x27;d3&#x27;
		}

	}

});

/**
 * MAIN EDIT-MODE
 */
 define(function(require) {

 	require(
 		[ &#x27;jquery&#x27;, &#x27;config&#x27;],
 		function($,Config) {
 			// var absPathToRequestHandler = &#x27;http://localhost/wordpress/wp-content/plugins/test/&#x27;;
 			var absPathToRequestHandler = &quot;../../&quot;;
				// ************************************************************************
				// HELPER
				// ************************************************************************
				var fetshAndRegisterExternaFiles = function(vLib){

					var jsonObj = {&quot;action&quot;: &quot;get_files&quot;};
					var postData = JSON.stringify(jsonObj);
					var postArray = {json:postData};
					$.ajax({
						type: &#x27;POST&#x27;,
						url: absPathToRequestHandler+&quot;process.php&quot;,
						data: postArray,
						success: function(data){

							vLib.emptyFileList();
							if(data !== &quot;&quot;){

								var d = $.parseJSON(data);
								for (var i=0; i &lt; d.length; i++) {
									var fileTmp = {
										id 	: d[i].id,
										path	: d[i].file_path,
										name		: d[i].file_name,
										description	: d[i].file_description,
										coordOne		: d[i].coord_one,
										coordTwo		: d[i].coord_two,
										coordThree		: d[i].coord_three
									};
									vLib.registerFile(_.clone(fileTmp));

								}

							}
						// notify list-update
						vLib.publish(Config.CHANNEL_REFRESH);
					}
				});
				}
				var fetshAndRegisterTemplates = function(vLib){
					var jsonObj = {&quot;action&quot;: &quot;get_t&quot;};
					var postData = JSON.stringify(jsonObj);
					var postArray = {json:postData};
					$.ajax({
						type: &#x27;POST&#x27;,
						url: absPathToRequestHandler+&quot;process.php&quot;,
						data: postArray,
						success: function(data){
							v.emptyTemplateList();
							if(data !== &quot;&quot;){
								var d = $.parseJSON(data);
								for (var i=0; i &lt; d.length; i++) {
									var templateTmp = {
										id 		 : d[i].id,
										sceneGraph	: JSON.parse(d[i].template_graph),
										name		: d[i].template_name,
										description	: d[i].template_description
									};
									vLib.registerTemplate(_.clone(templateTmp));
								}
							}

							// notify list-update
							v.publish(Config.CHANNEL_REQUEST_TEMPLATES);
						}
					});
				}
				// ************************************************************************
				// CALLBACKS
				// ************************************************************************
				var fileDeleteCB = function(fileIDArray){


					var jsonObj = {};
					console.log(jsonObj);
					jsonObj.action= &quot;delete_files&quot;;
					jsonObj.files= fileIDArray;
					console.log(jsonObj);
					//var jsonObj = fileIDArray;
					var postData = JSON.stringify(jsonObj);
					var postArray = {json:postData};
					$.ajax({
						type: &#x27;POST&#x27;,
						url: absPathToRequestHandler+&quot;process.php&quot;,
						data: postArray,
						success: function(response){

							if(response === &quot;1&quot;){
								v.publish(Config.CHANNEL_SUCCESS,&#x27;Files deleted! &#x27;);
								fetshAndRegisterExternaFiles();
							}else{
								v.publish(Config.CHANNEL_ERROR,&#x27;Delete files failed! Response=&#x27;+response+&#x27;] &#x27;);
							}
						},
						error: function(e){
							v.publish(Config.CHANNEL_ERROR,&#x27;Delete files failed! &#x27;+e);
						},
					});


				}
				var fileUploadCB = function(formId){

					var formData = new FormData($(formId)[0]);
					$.ajax({
						url: absPathToRequestHandler+&quot;processFileUpload.php&quot;,
						type: &#x27;POST&#x27;,

						        //Ajax events
						        beforeSend: function(e){},
						        success: function(e){
						        	v.publish(Config.CHANNEL_SUCCESS,&#x27;File upload done.! &#x27;+e);

						        	// UPDATE LIST
						        	fetshAndRegisterExternaFiles(v);

						        },
						        error: function(e){
						        	v.publish(Config.CHANNEL_ERROR,&#x27;Error occurred during file upload! &#x27;+e);
						        },
						        // Form data
						        data: formData,
						        //Options to tell jQuery not to process data or worry about content-type.
						        cache: false,
						        contentType: false,
						        processData: false
						    });


				}

				var deleteTemplateCB = function(template){
					// alert(&#x27;DELETE TEMPLATE CALLBACK in MAIN called: id=&#x27;
					// 	+template.id
					// 	+ &quot; name=&quot; +template.name
					// 	+&quot; description=&quot;+template.description+
					// 	&quot; scG=&quot;+template.sceneGraph);
					// ADD AJAX CALL HERE...

					template.action = &quot;delete_t&quot;;
					var jsonObj = template;
					var postData = JSON.stringify(jsonObj);
					var postArray = {json:postData};
					$.ajax({
						type: &#x27;POST&#x27;,
						url: absPathToRequestHandler+&quot;process.php&quot;,
						data: postArray,
						success: function(response){

							if(response === &quot;1&quot;){
								v.publish(Config.CHANNEL_SUCCESS,&#x27;Template deleted! &#x27;);
								fetshAndRegisterTemplates(v);
							}else{
								v.publish(Config.CHANNEL_ERROR,&#x27;Delete template failed! Response=&#x27;+response+&#x27;] &#x27;);
							}
						},
						error: function(e){
							v.publish(Config.CHANNEL_ERROR,&#x27;Delete template failed! &#x27;+e);
						},
					});


				}
				var saveTemplateCB = function(obj){

					var template = obj.template;
					if(template.name === &quot;&quot;){
						alert(&quot;Please set at least a template-name!&quot;);
						return;
					}
					if(!template.sceneGraph){
						alert(&quot;No SceneGraph template given!&quot;);
						return;
					}
					var jsonObj = {
						action : &quot;save&quot;,
						name 		: template.name,
						description 	: template.description,
						sceneGraph 	: template.sceneGraph
					}
					var postData = JSON.stringify(jsonObj);
					var postArray = {json: postData};

					$.ajax({
						type: &#x27;POST&#x27;,
						url: absPathToRequestHandler+&quot;process.php&quot;,
						data: postArray,
						success: function(data){
							v.publish(Config.CHANNEL_SUCCESS,&#x27;Template saved! &#x27;+data);
							// UPDATE LIST
							fetshAndRegisterTemplates(v);

						},
						error: function(e){
							v.publish(Config.CHANNEL_ERROR,&#x27;Save template failed! &#x27;+JSON.stringify(e));
						}
					});



				}

				// ************************************************************************
				// INIT vLIB
				// ************************************************************************
				var VLib = require(&#x27;vlib&#x27;);
				var v = new VLib();
				console.log(&quot;VLib version &quot; + v.version);
				// ************************************************************************
				// REGISTER CORE MODULES
				// ************************************************************************
				var templates = require(&#x27;core/modules/templates/templates.vlib&#x27;);
				var controls = require(&#x27;core/modules/controls/controls.vlib&#x27;);
				var toolbox = require(&#x27;core/modules/toolbox/toolbox.vlib&#x27;);
				var sceneGraph = require(&#x27;core/modules/scenegraph/scenegraph.vlib&#x27;);
				var plotModule = require(&#x27;core/modules/plot/plot.vlib&#x27;);
				var plot = new plotModule();
				v.registerModule(templates);
				v.registerModule(controls);
				v.registerModule(toolbox);
				v.registerModule(sceneGraph);
				v.registerModule(plot);

				// DELETE DATA CALLBACK
				// TODO: FILL CALLBACK FUNCTION. JQUERY-POST DELETE FROM DB
				// ************************************************************************
				v.setDeleteDataCallback(fileDeleteCB);
				// ************************************************************************
				// UPLOAD DATA CALLBACK
				// TODO: FILL CALLBACK FUNCTION. JQUERY-POST template &amp; insert into DB
				// ************************************************************************
				v.setUploadDataCallback(fileUploadCB);
				// ************************************************************************
				// SAVE TEMPLATE CALLBACK
				// TODO: FILL CALLBACK FUNCTION. JQUERY-POST template &amp; insert into DB
				// ************************************************************************
				v.setSaveTemplateCallback(saveTemplateCB);
				// ************************************************************************
				// DELETE TEMPLATE CALLBACK
				// TODO: DELETE DATASET FROM DB
				// ************************************************************************
				v.setDeleteTemplateCallback(deleteTemplateCB);

				// ************************************************************************
				// INIT
				// ************************************************************************
				templates.init(&#x27;#vTempl&#x27;);
				controls.init(&#x27;#vControls&#x27;);
				sceneGraph.init(&#x27;#vGraph&#x27;);
				toolbox.init(&#x27;#vList&#x27;);
				plot.init(&#x27;#vPlot&#x27;);
				// ************************************************************************
				// REGISTER DATA FILES
				// FILLED VIA PHP DATABASE REQUEST
				// ************************************************************************
				fetshAndRegisterExternaFiles(v);
				// ************************************************************************
				// REGISTER templates
				// TODO: FIll HELPER FUNCTION. FETSH TEMPLALTES
				// FROM YOUR SERVER AND REGISTER THEM AT VLIB.
				// e.g.: vLib.registerFile({
				//			path		: FILE_PATH,
				//			name		: FILE_NAME,
				//			description	: FILE_DESCRIPTION
				//			});
				// ************************************************************************
				fetshAndRegisterTemplates(v);
				console.log(&#x27;#######################################&#x27;);
				console.log(&#x27;[ main ][channels in use ] &#x27;
					+ Object.keys(v.getChannels));
				console.log(&#x27;[ main ][plugins in use ] &#x27;
					+ Object.keys(v.getPlugins));

				console.log(&quot;#########################################&quot;);
			});






});

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
